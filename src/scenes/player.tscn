[gd_scene format=3 uid="uid://bum3w3ougalos"]

[ext_resource type="PackedScene" uid="uid://blcdujkt26nhf" path="res://assets/main_character/main_character.glb" id="1_cusn3"]

[sub_resource type="GDScript" id="GDScript_26beo"]
script/source = "extends CharacterBody3D

const SPEED = 5.0
const JUMP_VELOCITY = 4.5

var max_life : int = 5
var current_life : int = max_life

func _physics_process(delta: float) -> void:
	# Add the gravity.
	if not is_on_floor():
		velocity += get_gravity() * delta

	# Handle jump.
	if Input.is_action_just_pressed(\"ui_accept\") and is_on_floor():
		velocity.y = JUMP_VELOCITY

	# Get the input direction and handle the movement/deceleration.
	# As good practice, you should replace UI actions with custom gameplay actions.
	var input_dir := Input.get_vector(\"ui_left\", \"ui_right\", \"ui_up\", \"ui_down\")
	var direction := (transform.basis * Vector3(input_dir.x, 0, input_dir.y)).normalized()
	if direction:
		velocity.x = direction.x * SPEED
		velocity.z = direction.z * SPEED
	else:
		velocity.x = move_toward(velocity.x, 0, SPEED)
		velocity.z = move_toward(velocity.z, 0, SPEED)

	move_and_slide()

func _input(event: InputEvent) -> void:
	if event.is_action_pressed(\"ui_cancel\"):
		remove_life()

func remove_life() -> void:
	if current_life > 0:
		current_life = current_life - 1
		$Torch.light_energy = current_life / float(max_life)
"

[sub_resource type="CapsuleMesh" id="CapsuleMesh_26beo"]

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_26beo"]
height = 4.1674805

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_cusn3"]
animation = &"marche_devant"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_v4rts"]
animation = &"marche_droite"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_hwyk6"]
animation = &"marche_left"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_l2v1k"]
animation = &"marche_arriere"

[sub_resource type="AnimationNodeBlendSpace2D" id="AnimationNodeBlendSpace2D_ya6j6"]
blend_point_0/node = SubResource("AnimationNodeAnimation_cusn3")
blend_point_0/pos = Vector2(0, 1)
blend_point_1/node = SubResource("AnimationNodeAnimation_v4rts")
blend_point_1/pos = Vector2(1, 0)
blend_point_2/node = SubResource("AnimationNodeAnimation_hwyk6")
blend_point_2/pos = Vector2(-1, 0)
blend_point_3/node = SubResource("AnimationNodeAnimation_l2v1k")
blend_point_3/pos = Vector2(0, -1)
sync = true

[sub_resource type="AnimationNodeBlendTree" id="AnimationNodeBlendTree_0qy4j"]
nodes/output/position = Vector2(792, 181)
nodes/BlendSpace2D/node = SubResource("AnimationNodeBlendSpace2D_ya6j6")
nodes/BlendSpace2D/position = Vector2(445, 155)
node_connections = [&"output", 0, &"BlendSpace2D"]

[node name="Player" type="CharacterBody3D" unique_id=460088547]
script = SubResource("GDScript_26beo")

[node name="MeshInstance3D" type="MeshInstance3D" parent="." unique_id=1107719430]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)
visible = false
mesh = SubResource("CapsuleMesh_26beo")

[node name="CollisionShape3D" type="CollisionShape3D" parent="." unique_id=297260006]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 2.0837402, 0)
shape = SubResource("CapsuleShape3D_26beo")

[node name="Dialog" type="Label3D" parent="." unique_id=471950260]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 4.8432665, 0)
billboard = 1
text = "Hello
Je oeuf"
vertical_alignment = 2

[node name="main_character" parent="." unique_id=805796366 instance=ExtResource("1_cusn3")]

[node name="Skeleton3D" parent="main_character/Armature" parent_id_path=PackedInt32Array(805796366, 130971939) index="0" unique_id=941462257]
bones/0/position = Vector3(2.385511, -3.4569077, -260.3428)
bones/0/rotation = Quaternion(-0.668815, -0.17455222, 0.17949446, 0.6999998)
bones/1/position = Vector3(6.16996e-07, 19.411167, -0.35083652)
bones/1/rotation = Quaternion(0.03633939, -0.059411723, 0.0061829584, 0.99755275)
bones/2/position = Vector3(7.448283e-07, 22.650112, -1.961487e-06)
bones/2/rotation = Quaternion(0.037336096, -0.020180644, 0.004757853, 0.9990877)
bones/3/position = Vector3(7.0790213e-07, 25.885841, 5.624e-07)
bones/3/rotation = Quaternion(0.03836434, -0.0121799605, 0.006701337, 0.9991672)
bones/4/position = Vector3(-4.5540293e-07, 29.121515, -8.196838e-08)
bones/4/rotation = Quaternion(-0.016449507, 0.06721863, -0.07604551, 0.9947001)
bones/5/position = Vector3(-1.4062479e-06, 33.54076, -0.30646905)
bones/5/rotation = Quaternion(-0.12628727, 0.04200914, 0.010409691, 0.99104923)
bones/6/position = Vector3(1.2204083e-06, 76.448425, -0.6985457)
bones/7/position = Vector3(10.745466, 26.459808, -0.026407393)
bones/7/rotation = Quaternion(-0.61772716, -0.38109377, 0.4241824, -0.54152566)
bones/8/position = Vector3(2.8217573e-06, 22.018215, 2.8886656e-05)
bones/8/rotation = Quaternion(0.1973872, -0.48875496, 0.15350471, 0.835819)
bones/9/position = Vector3(-2.2105394e-05, 59.04633, -1.051772e-05)
bones/9/rotation = Quaternion(-0.03547341, 0.053941406, 0.57997566, 0.8120716)
bones/10/position = Vector3(9.948636e-07, 52.630695, -8.257191e-06)
bones/10/rotation = Quaternion(-0.053017452, -0.32586232, -0.11194824, 0.93726766)
bones/11/position = Vector3(-8.431601, 7.124861, -5.2388596e-06)
bones/11/rotation = Quaternion(0.27032292, 0.22962067, 0.21934819, 0.9088929)
bones/12/position = Vector3(-2.1539502, 8.56437, 1.3076847e-05)
bones/12/rotation = Quaternion(0.033633806, 0.021140328, -0.109951966, 0.9931427)
bones/13/position = Vector3(0.4728869, 8.9476185, -1.8666856e-06)
bones/13/rotation = Quaternion(0.106576286, -0.05296999, -0.35247028, 0.9282243)
bones/14/position = Vector3(1.6810502, 6.3148427, -1.7411381e-06)
bones/15/position = Vector3(2.7037211e-05, 15.680069, -1.1261988e-05)
bones/15/rotation = Quaternion(0.45890525, 0.09837916, 0.04332813, 0.8819582)
bones/16/position = Vector3(0.3302821, 16.339533, 1.24117305e-05)
bones/16/rotation = Quaternion(0.52397805, -0.0061312746, 0.1029112, 0.84546953)
bones/17/position = Vector3(-0.06327223, 9.598878, -2.0352805e-05)
bones/17/rotation = Quaternion(0.46968722, 0.013563746, 0.07643645, 0.8794131)
bones/18/position = Vector3(-0.26701182, 9.334175, 2.3641824e-06)
bones/19/position = Vector3(-10.745471, 26.460592, -0.069784895)
bones/19/rotation = Quaternion(0.6176168, -0.42519253, 0.5156754, 0.41453546)
bones/20/position = Vector3(-4.3239197e-06, 22.018219, -8.313533e-06)
bones/20/rotation = Quaternion(0.42668274, 0.019501422, 0.026369337, 0.9038065)
bones/21/position = Vector3(-1.4133716e-06, 59.043484, -3.2592438e-06)
bones/21/rotation = Quaternion(-0.013045827, -0.06885274, -0.20676439, 0.97587794)
bones/22/position = Vector3(-2.2115912e-06, 52.628654, 1.995074e-06)
bones/22/rotation = Quaternion(0.0142868245, -0.16367364, -0.017177274, 0.9862615)
bones/23/position = Vector3(9.215055, 7.4555125, 6.471449e-06)
bones/23/rotation = Quaternion(0.007935351, -0.23122413, -0.10423353, 0.9672683)
bones/24/position = Vector3(2.436333, 9.1643505, 1.5423664e-05)
bones/24/rotation = Quaternion(0.12564762, 0.1741739, 0.048528574, 0.97545946)
bones/25/position = Vector3(-0.20267771, 8.393711, -1.332406e-06)
bones/25/rotation = Quaternion(-0.023018695, 0.07674206, -0.16493571, 0.9830448)
bones/26/position = Vector3(-2.2336533, 5.7793016, 8.211612e-06)
bones/27/position = Vector3(1.0246578e-05, 15.566106, 9.5182495e-06)
bones/27/rotation = Quaternion(0.110276625, -0.02703992, 0.0010287944, 0.99353254)
bones/28/position = Vector3(0.124189705, 16.211378, -1.7507647e-05)
bones/28/rotation = Quaternion(0.18774849, 0.02730828, -0.074296206, 0.9790224)
bones/29/position = Vector3(-0.43837482, 10.393857, 7.2174257e-06)
bones/29/rotation = Quaternion(0.1592361, 0.023692857, 0.021153348, 0.98672944)
bones/30/position = Vector3(0.31417334, 9.158808, 3.413522e-06)
bones/31/position = Vector3(15.116846, -10.792836, 0.215358)
bones/31/rotation = Quaternion(0.045413103, 0.2898037, 0.955263, -0.03773775)
bones/32/position = Vector3(4.2352035e-06, 118.658966, -5.459206e-06)
bones/32/rotation = Quaternion(-0.5789441, -0.06824154, -0.030946374, 0.81191707)
bones/33/position = Vector3(-2.6402868e-06, 106.503845, -3.318562e-06)
bones/33/rotation = Quaternion(0.43380198, -0.035761848, -0.048277974, 0.8990029)
bones/34/rotation = Quaternion(0.37808484, 0.01655548, -0.004658505, 0.92561126)
bones/36/position = Vector3(-15.116844, -10.792828, -0.05813324)
bones/36/rotation = Quaternion(-0.049223784, 0.2575329, 0.9649976, 0.005793251)
bones/37/rotation = Quaternion(-0.36286613, 0.0005507486, 0.0395656, 0.9310008)
bones/38/rotation = Quaternion(0.5775244, 0.011296258, -0.044190396, 0.8150982)
bones/39/rotation = Quaternion(0.3420524, -0.0049439734, 0.0028275421, 0.9396637)

[node name="BoneAttachment3D" type="BoneAttachment3D" parent="main_character/Armature/Skeleton3D" index="0" unique_id=186672180]
transform = Transform3D(-0.11985406, -0.35497877, -0.92715967, 0.35875353, 0.8553002, -0.37384176, 0.9257057, -0.3774284, 0.024838746, -6.6248875, 122.22926, -348.97638)
bone_name = "mixamorig_LeftHand"
bone_idx = 10

[node name="Torch" type="OmniLight3D" parent="main_character/Armature/Skeleton3D/BoneAttachment3D" unique_id=225046883]
transform = Transform3D(2.519123, -98.26082, 18.397251, -17.63553, 17.677647, 96.83222, -98.40042, -5.68376, -16.883537, -37.44214, 6.307434, -18.377289)
light_color = Color(0.9999997, 0.7524437, 0.66248655, 1)
shadow_enabled = true

[node name="AnimationTree" type="AnimationTree" parent="." unique_id=771295286]
root_node = NodePath("../main_character")
root_motion_track = NodePath("Armature/Skeleton3D:mixamorig_Hips")
tree_root = SubResource("AnimationNodeBlendTree_0qy4j")
anim_player = NodePath("../main_character/AnimationPlayer")
parameters/BlendSpace2D/blend_position = Vector2(0.013443589, -0.04186046)

[node name="RootMotionView" type="RootMotionView" parent="." unique_id=1027479428]
visible = false

[editable path="main_character"]
